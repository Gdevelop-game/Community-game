var gdjs;(function(m){const a=class extends m.RuntimeBehavior{constructor(e,t,n){super(e,t,n);this._tweens={};this._isActive=!0;this._runtimeScene=e}updateFromBehaviorData(e,t){return!0}_addTween(e,t,n,s){this._tweens[e]=new a.TweenInstance(t,!1,n,s)}_getTween(e){return this._tweens[e]}_tweenExists(e){return!!this._tweens[e]}_tweenIsPlaying(e){return this._tweens[e].instance.isPlaying()}_pauseTween(e){const t=this._tweens[e];t.instance.pause();const n=this._runtimeScene.shiftyJsScene;n&&n.remove(t.instance)}_resumeTween(e){const t=this._tweens[e];t.instance.resume();const n=this._runtimeScene.shiftyJsScene;n&&n.add(t.instance)}_stopTween(e,t){return this._tweens[e].instance.stop(t)}_setTweenFinished(e,t){this._tweens[e].hasFinished=t}_tweenHasFinished(e){return this._tweens[e].hasFinished}_removeObjectFromScene(e){return this._removeTween(e),this.owner.deleteFromScene(this._runtimeScene)}_removeTween(e){!this._tweens[e]||(this._tweens[e].instance.stop(),a.removeFromScene(this._runtimeScene,this._tweens[e].instance),delete this._tweens[e])}_setupTweenEnding(e,t){const n=this;t?this._tweens[e].instance.tween().then(function(){n._removeObjectFromScene(e)}).catch(function(){}):this._tweens[e].instance.tween().then(function(){n._tweens[e]&&(n._tweens[e].hasFinished=!0)}).catch(function(){})}addVariableTween(e,t,n,s,o,h,i){if(!this._isActive||a.easings[o])return;this._tweenExists(e)&&this.removeTween(e);const r=a.makeNewTweenable(this._runtimeScene);r.setConfig({from:{value:n},to:{value:s},duration:h,easing:o,step:function(w){t.setNumber(w.value)}}),this._addTween(e,r,this._runtimeScene.getTimeManager().getTimeFromStart(),h),this._setupTweenEnding(e,i)}addObjectPositionTween(e,t,n,s,o,h){const i=this;if(!this._isActive||a.easings[s])return;this._tweenExists(e)&&this.removeTween(e);const r=a.makeNewTweenable(this._runtimeScene);r.setConfig({from:{x:this.owner.getX(),y:this.owner.getY()},to:{x:t,y:n},duration:o,easing:s,step:function(w){i.owner.setX(w.x),i.owner.setY(w.y)}}),this._addTween(e,r,this._runtimeScene.getTimeManager().getTimeFromStart(),o),this._setupTweenEnding(e,h)}addObjectPositionXTween(e,t,n,s,o){const h=this;if(!this._isActive||a.easings[n])return;this._tweenExists(e)&&this.removeTween(e);const i=a.makeNewTweenable(this._runtimeScene);i.setConfig({from:{x:this.owner.getX()},to:{x:t},duration:s,easing:n,step:function(c){h.owner.setX(c.x)}}),this._addTween(e,i,this._runtimeScene.getTimeManager().getTimeFromStart(),s),this._setupTweenEnding(e,o)}addObjectPositionYTween(e,t,n,s,o){const h=this;if(!this._isActive||a.easings[n])return;this._tweenExists(e)&&this.removeTween(e);const i=a.makeNewTweenable(this._runtimeScene);i.setConfig({from:{y:this.owner.getY()},to:{y:t},duration:s,easing:n,step:function(c){h.owner.setY(c.y)}}),this._addTween(e,i,this._runtimeScene.getTimeManager().getTimeFromStart(),s),this._setupTweenEnding(e,o)}addObjectAngleTween(e,t,n,s,o){const h=this;if(!this._isActive||a.easings[n])return;this._tweenExists(e)&&this.removeTween(e);const i=a.makeNewTweenable(this._runtimeScene);i.setConfig({from:{angle:this.owner.getAngle()},to:{angle:t},duration:s,easing:n,step:function(c){h.owner.setAngle(c.angle)}}),this._addTween(e,i,this._runtimeScene.getTimeManager().getTimeFromStart(),s),this._setupTweenEnding(e,o)}addObjectScaleTween(e,t,n,s,o,h,i){const r=this;if(!this._isActive||!this.owner.setScaleX||!this.owner.setScaleY||a.easings[s])return;this._tweenExists(e)&&this.removeTween(e),t<0&&(t=0),n<0&&(n=0);const c=a.makeNewTweenable(this._runtimeScene);let w;i?w=function(T){const f=r.owner.getCenterXInScene(),_=r.owner.getCenterYInScene();r.owner.setScaleX(T.scaleX),r.owner.setScaleY(T.scaleY),r.owner.setCenterPositionInScene(f,_)}:w=function(T){r.owner.setScaleX(T.scaleX),r.owner.setScaleY(T.scaleY)},c.setConfig({from:{scaleX:this.owner.getScaleX(),scaleY:this.owner.getScaleY()},to:{scaleX:t,scaleY:n},duration:o,easing:s,step:w}),this._addTween(e,c,this._runtimeScene.getTimeManager().getTimeFromStart(),o),this._setupTweenEnding(e,h)}addObjectScaleXTween(e,t,n,s,o,h){const i=this;if(!this._isActive||!this.owner.setScaleX||a.easings[n])return;this._tweenExists(e)&&this.removeTween(e);const r=a.makeNewTweenable(this._runtimeScene);let c;h?c=function(u){const T=i.owner.getCenterXInScene();i.owner.setScaleX(u.scaleX),i.owner.setCenterXInScene(T)}:c=function(u){i.owner.setScaleX(u.scaleX)},r.setConfig({from:{scaleX:this.owner.getScaleX()},to:{scaleX:t},duration:s,easing:n,step:c}),this._addTween(e,r,this._runtimeScene.getTimeManager().getTimeFromStart(),s),this._setupTweenEnding(e,o)}addObjectScaleYTween(e,t,n,s,o,h){const i=this;if(!this._isActive||!this.owner.setScaleY||a.easings[n])return;this._tweenExists(e)&&this.removeTween(e);const r=a.makeNewTweenable(this._runtimeScene);let c;h?c=function(u){const T=i.owner.getCenterYInScene();i.owner.setScaleY(u.scaleY),i.owner.setCenterYInScene(T)}:c=function(u){i.owner.setScaleY(u.scaleY)},r.setConfig({from:{scaleY:this.owner.getScaleY()},to:{scaleY:t},duration:s,easing:n,step:c}),this._addTween(e,r,this._runtimeScene.getTimeManager().getTimeFromStart(),s),this._setupTweenEnding(e,o)}addObjectOpacityTween(e,t,n,s,o){const h=this;if(!this._isActive||!this.owner.getOpacity||!this.owner.setOpacity||a.easings[n])return;this._tweenExists(e)&&this.removeTween(e);const i=a.makeNewTweenable(this._runtimeScene);i.setConfig({from:{opacity:this.owner.getOpacity()},to:{opacity:t},duration:s,easing:n,step:function(c){h.owner.setOpacity(c.opacity)}}),this._addTween(e,i,this._runtimeScene.getTimeManager().getTimeFromStart(),s),this._setupTweenEnding(e,o)}addObjectColorTween(e,t,n,s,o){const h=this;if(!this._isActive||!this.owner.getColor||!this.owner.setColor||!t.match("^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]);){2}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$")||a.easings[n])return;this._tweenExists(e)&&this.removeTween(e);const i=this.owner.getColor().split(";");let r=t.split(";");if(r.length!==3)return;const c=a.makeNewTweenable(this._runtimeScene);c.setConfig({from:{red:i[0],green:i[1],blue:i[2]},to:{red:r[0],green:r[1],blue:r[2]},duration:s,easing:n,step:function(u){h.owner.setColor(Math.floor(u.red)+";"+Math.floor(u.green)+";"+Math.floor(u.blue))}}),this._addTween(e,c,this._runtimeScene.getTimeManager().getTimeFromStart(),s),this._setupTweenEnding(e,o)}addTextObjectCharacterSizeTween(e,t,n,s,o){const h=this;if(!this._isActive||!this.owner.setCharacterSize||a.easings[n])return;this._tweenExists(e)&&this.removeTween(e);const i=a.makeNewTweenable(this._runtimeScene);i.setConfig({from:{size:this.owner.getCharacterSize()},to:{size:t},duration:s,easing:n,step:function(c){h.owner.setCharacterSize(c.size)}}),this._addTween(e,i,this._runtimeScene.getTimeManager().getTimeFromStart(),s),this._setupTweenEnding(e,o)}addObjectWidthTween(e,t,n,s,o){const h=this;if(!this._isActive||a.easings[n])return;this._tweenExists(e)&&this.removeTween(e);const i=a.makeNewTweenable(this._runtimeScene);i.setConfig({from:{width:this.owner.getWidth()},to:{width:t},duration:s,easing:n,step:function(c){h.owner.setWidth(c.width)}}),this._addTween(e,i,this._runtimeScene.getTimeManager().getTimeFromStart(),s),this._setupTweenEnding(e,o)}addObjectHeightTween(e,t,n,s,o){const h=this;if(!this._isActive||a.easings[n])return;this._tweenExists(e)&&this.removeTween(e);const i=a.makeNewTweenable(this._runtimeScene);i.setConfig({from:{height:this.owner.getHeight()},to:{height:t},duration:s,easing:n,step:function(c){h.owner.setHeight(c.height)}}),this._addTween(e,i,this._runtimeScene.getTimeManager().getTimeFromStart(),s),this._setupTweenEnding(e,o)}isPlaying(e){return!!(this._tweenExists(e)&&this._tweenIsPlaying(e))}exists(e){return this._tweenExists(e)}hasFinished(e){return this._tweenExists(e)?this._tweenHasFinished(e):!1}pauseTween(e){!this._isActive||this._tweenExists(e)&&this._tweenIsPlaying(e)&&this._pauseTween(e)}stopTween(e,t){!this._isActive||this._tweenExists(e)&&this._tweenIsPlaying(e)&&this._stopTween(e,t)}resumeTween(e){!this._isActive||this._tweenExists(e)&&!this._tweenIsPlaying(e)&&this._resumeTween(e)}removeTween(e){this._removeTween(e)}getProgress(e){const t=this._getTween(e);if(t){const n=this._runtimeScene.getTimeManager().getTimeFromStart();return n>=t.startTime+t.totalDuration?1:(n-t.startTime)/t.totalDuration}else return 0}onDeActivate(){if(!!this._isActive){for(const e in this._tweens)if(this._tweens.hasOwnProperty(e)){const t=this._tweens[e];t.instance.isPlaying()&&(t.resumeOnActivate=!0,this._pauseTween(e))}this._isActive=!1}}onActivate(){if(!this._isActive){for(const e in this._tweens)if(this._tweens.hasOwnProperty(e)){const t=this._tweens[e];t.resumeOnActivate&&(t.resumeOnActivate=!1,this._resumeTween(e))}this._isActive=!0}}static makeNewTweenable(e){e.shiftyJsScene||(e.shiftyJsScene=new shifty.Scene);const t=new shifty.Tweenable;return e.shiftyJsScene.add(t),t}static removeFromScene(e,t){!e.shiftyJsScene||e.shiftyJsScene.remove(t)}};let g=a;g.easings=["linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeOutBounce","easeInBack","easeOutBack","easeInOutBack","elastic","swingFromTo","swingFrom","swingTo","bounce","bouncePast","easeFromTo","easeFrom","easeTo"],g._tweensProcessed=!1,g._currentTweenTime=0,m.TweenRuntimeBehavior=g,m.registerBehavior("Tween::TweenBehavior",m.TweenRuntimeBehavior),function(e){class l{constructor(n,s,o,h){this.resumeOnActivate=!1;this.instance=n,this.hasFinished=s,this.startTime=o,this.totalDuration=h}}e.TweenInstance=l}(g=m.TweenRuntimeBehavior||(m.TweenRuntimeBehavior={})),m.registerRuntimeSceneUnloadedCallback(function(l){const e=l.shiftyJsScene;!e||(e.stop(!1),e.tweenables.forEach(e.remove.bind(e)))}),m.registerRuntimeScenePausedCallback(function(l){const e=l.shiftyJsScene;!e||e.pause()}),m.registerRuntimeSceneResumedCallback(function(l){const e=l.shiftyJsScene;!e||(g._currentTweenTime=l.getTimeManager().getTimeFromStart(),e.resume())}),m.registerRuntimeScenePreEventsCallback(function(l){g._currentTweenTime=l.getTimeManager().getTimeFromStart(),shifty.processTweens()}),shifty.Tweenable.setScheduleFunction(function(){}),shifty.Tweenable.now=function(){return g._currentTweenTime}})(gdjs||(gdjs={}));
//# sourceMappingURL=tweenruntimebehavior.js.map
